@startuml
!include style.puml
skinparam ArrowFontStyle plain
skinparam sequenceReferenceBackgroundColor #D3D3D3

Actor User as user USER_COLOR
Participant ":UI" as ui UI_COLOR


box Logic LOGIC_COLOR_T1
Participant ":LogicManager" as logic LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
Participant ":ModelManager" as model MODEL_COLOR
Participant "hist:ReadOnlyCommandHistory" as roch MODEL_COLOR
end box

box Storage STORAGE_COLOR_T1
Participant ":StorageManager" as storage STORAGE_COLOR
end box

user -[USER_COLOR]> ui : "tag 1 t\\newtag"
activate ui UI_COLOR

ui -> logic: execute("tag 1 t\\newtag")
activate logic LOGIC_COLOR

ref over logic: parseAndExecuteCommand
logic -> model: addCommandToHistory("tag")
activate model MODEL_COLOR
note left of logic
    addCommandToHistory()
    will not be executed if
    execution of command fails,
    since an error is thrown
    and propagated up
end note


model --> logic
deactivate model

logic -> model: getCommandHistory()
activate model MODEL_COLOR

model --> logic: hist
deactivate model

logic -> storage: saveCommandHistory(hist)
activate storage STORAGE_COLOR

ref over storage: saveCommandHistory

storage --> logic
deactivate storage

logic --> ui
deactivate logic

ui --> user
deactivate ui

user -> ui: <ARROW_KEY_UP>
activate ui UI_COLOR

ui -> roch: getPreviousCommandFromHistory(currCommandBoxText)
activate roch MODEL_COLOR

roch --> ui: "tag 1 t\\newtag"
deactivate roch


ui -> ui : setCommandBoxText("tag..")

ui --> user
deactivate ui

@enduml
